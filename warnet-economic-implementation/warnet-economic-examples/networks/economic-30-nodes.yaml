# Economic Node Test Network - 30 Node Configuration
# BCAP-Aligned Economic Node Implementation
#
# Economic Node Definition (BCAP Framework):
# "Economic Nodes are full nodes that not only validate and relay transactions,
#  but also receive and send substantial amounts of bitcoin payments. Economic
#  Nodes have power and influence which is proportional to the frequency and
#  volume of payments received."
#
# Economic Power Metrics (Dual Model):
# - PRIMARY: Custody (% of BTC supply under validation)
# - SECONDARY: Payment volume (daily transaction flow)
# - DERIVED: Consensus weight (primarily custody-based)
#
# Network Distribution:
# - 5 Economic Nodes (17% of nodes, ~27% of consensus weight)
# - 20 Relay Nodes (66% of nodes)
# - 5 Constrained Nodes (17% of nodes)
#
# Circulating Supply Assumption: 19,500,000 BTC

network:
  name: economic-node-test-30
  description: "Test network with Economic Nodes for BCAP scenario testing"
  
nodes:
  # ============================================================================
  # ECONOMIC NODES (5 nodes, 17% of network)
  # ============================================================================
  
  # Exchange Node 1 - Tier 1 (MAJOR EXCHANGE: Coinbase-scale)
  - name: exchange-tier1-coinbase
    image: "bitcoindevproject/bitcoin:27.0"
    tags:
      - economic_node
      - exchange
      - tier_1
      - major_exchange
      - high_volume
    metadata:
      node_type: major_exchange
      entity_name: "Coinbase-scale Exchange"
      adoption_speed: fast  # Quick to adopt/reject changes

      # PRIMARY METRIC: Supply Validation (Custody)
      custody_btc: 2000000  # 2 million BTC in custody
      supply_percentage: 10.3  # (2M / 19.5M circulating supply)
      custody_notes: "Hot wallets + cold storage"

      # SECONDARY METRIC: Payment Flow (Daily)
      daily_deposits_btc: 100000  # Daily customer deposits
      daily_withdrawals_btc: 95000  # Daily customer withdrawals
      daily_volume_btc: 100000  # Total daily payment flow
      payment_notes: "High-frequency retail + institutional"

      # DERIVED: Consensus Weight
      consensus_weight: 10.3  # Primarily based on custody percentage
      weight_calculation: "custody_primary_flow_secondary"
      economic_influence: "critical"
    bitcoin_config:
      maxconnections: 2000
      maxmempool: 10000  # 10GB
      rpcthreads: 32
      txindex: 1  # Exchanges typically need full tx index
      listen: 1
      discover: 1
    resources:
      requests:
        cpu: "4000m"
        memory: "16Gi"
      limits:
        cpu: "8000m"
        memory: "32Gi"
    connections:
      # Connect to other economic nodes
      - exchange-tier1-binance
      - exchange-tier2-kraken
      - payment-processor-bitpay
      - custody-fidelity
      # Connect to many relay nodes (hub position)
      - relay-node-1
      - relay-node-2
      - relay-node-5
      - relay-node-7
      - relay-node-10
      - relay-node-15
      - relay-node-18
  
  # Exchange Node 2 - Tier 1 (MAJOR EXCHANGE: Binance-scale)
  - name: exchange-tier1-binance
    image: "bitcoindevproject/bitcoin:27.0"
    tags:
      - economic_node
      - exchange
      - tier_1
      - major_exchange
      - high_volume
    metadata:
      node_type: major_exchange
      entity_name: "Binance-scale Exchange"
      adoption_speed: fast

      # PRIMARY METRIC: Supply Validation (Custody)
      custody_btc: 2200000  # 2.2 million BTC in custody
      supply_percentage: 11.3  # (2.2M / 19.5M circulating supply)
      custody_notes: "Global exchange, largest BTC reserves"

      # SECONDARY METRIC: Payment Flow (Daily)
      daily_deposits_btc: 110000  # Daily customer deposits
      daily_withdrawals_btc: 105000  # Daily customer withdrawals
      daily_volume_btc: 110000  # Total daily payment flow
      payment_notes: "Highest global trading volume"

      # DERIVED: Consensus Weight
      consensus_weight: 11.3  # Primarily based on custody percentage
      weight_calculation: "custody_primary_flow_secondary"
      economic_influence: "critical"
    bitcoin_config:
      maxconnections: 2000
      maxmempool: 10000
      rpcthreads: 32
      txindex: 1
    resources:
      requests:
        cpu: "4000m"
        memory: "16Gi"
      limits:
        cpu: "8000m"
        memory: "32Gi"
    connections:
      - exchange-tier1-coinbase
      - exchange-tier2-kraken
      - payment-processor-bitpay
      - relay-node-3
      - relay-node-4
      - relay-node-6
      - relay-node-8
      - relay-node-12
      - relay-node-16
      - relay-node-19
  
  # Exchange Node 3 - Tier 2 (REGIONAL EXCHANGE: Kraken-scale)
  - name: exchange-tier2-kraken
    image: "bitcoindevproject/bitcoin:27.0"
    tags:
      - economic_node
      - exchange
      - tier_2
      - regional_exchange
      - medium_volume
    metadata:
      node_type: regional_exchange
      entity_name: "Kraken-scale Regional Exchange"
      adoption_speed: medium

      # PRIMARY METRIC: Supply Validation (Custody)
      custody_btc: 450000  # 450k BTC in custody
      supply_percentage: 2.3  # (450k / 19.5M circulating supply)
      custody_notes: "Regional focus, strong security practices"

      # SECONDARY METRIC: Payment Flow (Daily)
      daily_deposits_btc: 30000  # Daily customer deposits
      daily_withdrawals_btc: 28000  # Daily customer withdrawals
      daily_volume_btc: 30000  # Total daily payment flow
      payment_notes: "Medium-volume regional trading"

      # DERIVED: Consensus Weight
      consensus_weight: 2.3  # Primarily based on custody percentage
      weight_calculation: "custody_primary_flow_secondary"
      economic_influence: "significant"
    bitcoin_config:
      maxconnections: 1000
      maxmempool: 5000  # 5GB
      rpcthreads: 16
      txindex: 1
    resources:
      requests:
        cpu: "2000m"
        memory: "8Gi"
      limits:
        cpu: "4000m"
        memory: "16Gi"
    connections:
      - exchange-tier1-coinbase
      - exchange-tier1-binance
      - custody-fidelity
      - relay-node-2
      - relay-node-9
      - relay-node-11
      - relay-node-14
      - relay-node-17
  
  # Payment Processor (BitPay/Strike-scale)
  - name: payment-processor-bitpay
    image: "bitcoindevproject/bitcoin:27.0"
    tags:
      - economic_node
      - payment_processor
      - medium_volume
      - operational_chokepoint
    metadata:
      node_type: payment_processor
      entity_name: "BitPay/Strike-scale Payment Processor"
      adoption_speed: medium

      # PRIMARY METRIC: Supply Validation (Custody)
      custody_btc: 30000  # 30k BTC in operational wallets
      supply_percentage: 0.15  # (30k / 19.5M circulating supply)
      custody_notes: "Hot wallets for payment processing, minimal custody"

      # SECONDARY METRIC: Payment Flow (Daily)
      daily_deposits_btc: 10000  # Daily merchant/customer payments
      daily_withdrawals_btc: 9500  # Daily payouts
      daily_volume_btc: 10000  # Total daily payment flow
      payment_notes: "High-frequency merchant payments, operational chokepoint"

      # DERIVED: Consensus Weight
      consensus_weight: 1.0  # Custody-based + operational importance
      weight_calculation: "custody_primary_flow_secondary"
      economic_influence: "moderate"
    bitcoin_config:
      maxconnections: 500
      maxmempool: 2000  # 2GB
      rpcthreads: 16
      # Payment processors may want faster propagation
      mempoolexpiry: 1  # 1 hour instead of default 72
    resources:
      requests:
        cpu: "2000m"
        memory: "4Gi"
      limits:
        cpu: "4000m"
        memory: "8Gi"
    connections:
      - exchange-tier1-coinbase
      - exchange-tier1-binance
      - relay-node-1
      - relay-node-5
      - relay-node-13
      - relay-node-20
  
  # Custody Provider (Fidelity Digital Assets-scale)
  - name: custody-fidelity
    image: "bitcoindevproject/bitcoin:27.0"
    tags:
      - economic_node
      - custody_provider
      - high_security
      - low_volume
      - institutional
    metadata:
      node_type: custody_provider
      entity_name: "Fidelity Digital Assets-scale Custodian"
      adoption_speed: slow  # Conservative, slow to change

      # PRIMARY METRIC: Supply Validation (Custody)
      custody_btc: 700000  # 700k BTC in custody
      supply_percentage: 3.6  # (700k / 19.5M circulating supply)
      custody_notes: "Institutional custody, cold storage dominant"

      # SECONDARY METRIC: Payment Flow (Daily)
      daily_deposits_btc: 3000  # Daily institutional deposits
      daily_withdrawals_btc: 2800  # Daily institutional withdrawals
      daily_volume_btc: 3000  # Total daily payment flow
      payment_notes: "Low-frequency institutional movements"

      # DERIVED: Consensus Weight
      consensus_weight: 3.6  # Primarily based on custody percentage
      weight_calculation: "custody_primary_flow_secondary"
      economic_influence: "significant"
    bitcoin_config:
      maxconnections: 300
      maxmempool: 3000  # 3GB
      rpcthreads: 8
      # Higher security settings
      listen: 1
      discover: 0  # Manual peer selection only
    resources:
      requests:
        cpu: "1000m"
        memory: "6Gi"
      limits:
        cpu: "2000m"
        memory: "12Gi"
    connections:
      - exchange-tier1-binance
      - exchange-tier2-kraken
      - relay-node-3
      - relay-node-7
      - relay-node-11
  
  # ============================================================================
  # RELAY NODES (20 nodes, 66% of network)
  # Standard Bitcoin Core nodes with default settings
  # ============================================================================
  
  - name: relay-node-1
    image: "bitcoindevproject/bitcoin:27.0"
    tags:
      - relay_node
      - standard
    metadata:
      weight: 1
      node_type: relay
    bitcoin_config:
      maxconnections: 125
      maxmempool: 300
    resources:
      requests:
        cpu: "500m"
        memory: "2Gi"
      limits:
        cpu: "1000m"
        memory: "4Gi"
    connections:
      - exchange-tier1-coinbase
      - payment-processor-bitpay
      - relay-node-2
      - relay-node-5
      - constrained-node-1
  
  - name: relay-node-2
    image: "bitcoindevproject/bitcoin:27.0"
    tags:
      - relay_node
      - standard
    metadata:
      weight: 1
      node_type: relay
    bitcoin_config:
      maxconnections: 125
      maxmempool: 300
    resources:
      requests:
        cpu: "500m"
        memory: "2Gi"
      limits:
        cpu: "1000m"
        memory: "4Gi"
    connections:
      - exchange-tier1-coinbase
      - exchange-tier2-kraken
      - relay-node-1
      - relay-node-3
      - relay-node-6
  
  - name: relay-node-3
    image: "bitcoindevproject/bitcoin:27.0"
    tags:
      - relay_node
      - standard
    metadata:
      weight: 1
      node_type: relay
    bitcoin_config:
      maxconnections: 125
      maxmempool: 300
    resources:
      requests:
        cpu: "500m"
        memory: "2Gi"
      limits:
        cpu: "1000m"
        memory: "4Gi"
    connections:
      - exchange-tier1-binance
      - custody-fidelity
      - relay-node-2
      - relay-node-4
      - constrained-node-2
  
  - name: relay-node-4
    image: "bitcoindevproject/bitcoin:26.0"  # Mixed version
    tags:
      - relay_node
      - standard
      - version_previous
    metadata:
      weight: 1
      node_type: relay
    bitcoin_config:
      maxconnections: 125
      maxmempool: 300
    resources:
      requests:
        cpu: "500m"
        memory: "2Gi"
      limits:
        cpu: "1000m"
        memory: "4Gi"
    connections:
      - exchange-tier1-binance
      - relay-node-3
      - relay-node-5
      - relay-node-8
  
  - name: relay-node-5
    image: "bitcoindevproject/bitcoin:27.0"
    tags:
      - relay_node
      - standard
    metadata:
      weight: 1
      node_type: relay
    bitcoin_config:
      maxconnections: 125
      maxmempool: 300
    resources:
      requests:
        cpu: "500m"
        memory: "2Gi"
      limits:
        cpu: "1000m"
        memory: "4Gi"
    connections:
      - exchange-tier1-coinbase
      - payment-processor-bitpay
      - relay-node-1
      - relay-node-4
      - relay-node-9
  
  - name: relay-node-6
    image: "bitcoindevproject/bitcoin:27.0"
    tags:
      - relay_node
      - standard
    metadata:
      weight: 1
      node_type: relay
    bitcoin_config:
      maxconnections: 125
      maxmempool: 300
    resources:
      requests:
        cpu: "500m"
        memory: "2Gi"
      limits:
        cpu: "1000m"
        memory: "4Gi"
    connections:
      - exchange-tier1-binance
      - relay-node-2
      - relay-node-7
      - relay-node-10
  
  - name: relay-node-7
    image: "bitcoindevproject/bitcoin:27.0"
    tags:
      - relay_node
      - standard
    metadata:
      weight: 1
      node_type: relay
    bitcoin_config:
      maxconnections: 125
      maxmempool: 300
    resources:
      requests:
        cpu: "500m"
        memory: "2Gi"
      limits:
        cpu: "1000m"
        memory: "4Gi"
    connections:
      - exchange-tier1-coinbase
      - custody-fidelity
      - relay-node-6
      - relay-node-11
      - constrained-node-3
  
  - name: relay-node-8
    image: "bitcoindevproject/bitcoin:26.0"  # Mixed version
    tags:
      - relay_node
      - standard
      - version_previous
    metadata:
      weight: 1
      node_type: relay
    bitcoin_config:
      maxconnections: 125
      maxmempool: 300
    resources:
      requests:
        cpu: "500m"
        memory: "2Gi"
      limits:
        cpu: "1000m"
        memory: "4Gi"
    connections:
      - exchange-tier1-binance
      - relay-node-4
      - relay-node-9
      - relay-node-12
  
  - name: relay-node-9
    image: "bitcoindevproject/bitcoin:27.0"
    tags:
      - relay_node
      - standard
    metadata:
      weight: 1
      node_type: relay
    bitcoin_config:
      maxconnections: 125
      maxmempool: 300
    resources:
      requests:
        cpu: "500m"
        memory: "2Gi"
      limits:
        cpu: "1000m"
        memory: "4Gi"
    connections:
      - exchange-tier2-kraken
      - relay-node-5
      - relay-node-8
      - relay-node-13
  
  - name: relay-node-10
    image: "bitcoindevproject/bitcoin:27.0"
    tags:
      - relay_node
      - standard
    metadata:
      weight: 1
      node_type: relay
    bitcoin_config:
      maxconnections: 125
      maxmempool: 300
    resources:
      requests:
        cpu: "500m"
        memory: "2Gi"
      limits:
        cpu: "1000m"
        memory: "4Gi"
    connections:
      - exchange-tier1-coinbase
      - relay-node-6
      - relay-node-11
      - relay-node-14
  
  - name: relay-node-11
    image: "bitcoindevproject/bitcoin:27.0"
    tags:
      - relay_node
      - standard
    metadata:
      weight: 1
      node_type: relay
    bitcoin_config:
      maxconnections: 125
      maxmempool: 300
    resources:
      requests:
        cpu: "500m"
        memory: "2Gi"
      limits:
        cpu: "1000m"
        memory: "4Gi"
    connections:
      - exchange-tier2-kraken
      - custody-fidelity
      - relay-node-7
      - relay-node-10
      - relay-node-15
  
  - name: relay-node-12
    image: "bitcoindevproject/bitcoin:25.0"  # Older version
    tags:
      - relay_node
      - standard
      - version_old
    metadata:
      weight: 1
      node_type: relay
    bitcoin_config:
      maxconnections: 125
      maxmempool: 300
    resources:
      requests:
        cpu: "500m"
        memory: "2Gi"
      limits:
        cpu: "1000m"
        memory: "4Gi"
    connections:
      - exchange-tier1-binance
      - relay-node-8
      - relay-node-13
      - relay-node-16
  
  - name: relay-node-13
    image: "bitcoindevproject/bitcoin:27.0"
    tags:
      - relay_node
      - standard
    metadata:
      weight: 1
      node_type: relay
    bitcoin_config:
      maxconnections: 125
      maxmempool: 300
    resources:
      requests:
        cpu: "500m"
        memory: "2Gi"
      limits:
        cpu: "1000m"
        memory: "4Gi"
    connections:
      - payment-processor-bitpay
      - relay-node-9
      - relay-node-12
      - relay-node-17
  
  - name: relay-node-14
    image: "bitcoindevproject/bitcoin:27.0"
    tags:
      - relay_node
      - standard
    metadata:
      weight: 1
      node_type: relay
    bitcoin_config:
      maxconnections: 125
      maxmempool: 300
    resources:
      requests:
        cpu: "500m"
        memory: "2Gi"
      limits:
        cpu: "1000m"
        memory: "4Gi"
    connections:
      - exchange-tier2-kraken
      - relay-node-10
      - relay-node-15
      - relay-node-18
      - constrained-node-4
  
  - name: relay-node-15
    image: "bitcoindevproject/bitcoin:27.0"
    tags:
      - relay_node
      - standard
    metadata:
      weight: 1
      node_type: relay
    bitcoin_config:
      maxconnections: 125
      maxmempool: 300
    resources:
      requests:
        cpu: "500m"
        memory: "2Gi"
      limits:
        cpu: "1000m"
        memory: "4Gi"
    connections:
      - exchange-tier1-coinbase
      - relay-node-11
      - relay-node-14
      - relay-node-19
  
  - name: relay-node-16
    image: "bitcoindevproject/bitcoin:26.0"  # Mixed version
    tags:
      - relay_node
      - standard
      - version_previous
    metadata:
      weight: 1
      node_type: relay
    bitcoin_config:
      maxconnections: 125
      maxmempool: 300
    resources:
      requests:
        cpu: "500m"
        memory: "2Gi"
      limits:
        cpu: "1000m"
        memory: "4Gi"
    connections:
      - exchange-tier1-binance
      - relay-node-12
      - relay-node-17
      - relay-node-20
  
  - name: relay-node-17
    image: "bitcoindevproject/bitcoin:27.0"
    tags:
      - relay_node
      - standard
    metadata:
      weight: 1
      node_type: relay
    bitcoin_config:
      maxconnections: 125
      maxmempool: 300
    resources:
      requests:
        cpu: "500m"
        memory: "2Gi"
      limits:
        cpu: "1000m"
        memory: "4Gi"
    connections:
      - exchange-tier2-kraken
      - relay-node-13
      - relay-node-16
      - relay-node-18
  
  - name: relay-node-18
    image: "bitcoindevproject/bitcoin:27.0"
    tags:
      - relay_node
      - standard
    metadata:
      weight: 1
      node_type: relay
    bitcoin_config:
      maxconnections: 125
      maxmempool: 300
    resources:
      requests:
        cpu: "500m"
        memory: "2Gi"
      limits:
        cpu: "1000m"
        memory: "4Gi"
    connections:
      - exchange-tier1-coinbase
      - relay-node-14
      - relay-node-17
      - relay-node-19
      - constrained-node-5
  
  - name: relay-node-19
    image: "bitcoindevproject/bitcoin:27.0"
    tags:
      - relay_node
      - standard
    metadata:
      weight: 1
      node_type: relay
    bitcoin_config:
      maxconnections: 125
      maxmempool: 300
    resources:
      requests:
        cpu: "500m"
        memory: "2Gi"
      limits:
        cpu: "1000m"
        memory: "4Gi"
    connections:
      - exchange-tier1-binance
      - relay-node-15
      - relay-node-18
      - relay-node-20
  
  - name: relay-node-20
    image: "bitcoindevproject/bitcoin:27.0"
    tags:
      - relay_node
      - standard
    metadata:
      weight: 1
      node_type: relay
    bitcoin_config:
      maxconnections: 125
      maxmempool: 300
    resources:
      requests:
        cpu: "500m"
        memory: "2Gi"
      limits:
        cpu: "1000m"
        memory: "4Gi"
    connections:
      - payment-processor-bitpay
      - relay-node-16
      - relay-node-19
  
  # ============================================================================
  # CONSTRAINED NODES (5 nodes, 17% of network)
  # Resource-limited nodes, older versions
  # ============================================================================
  
  - name: constrained-node-1
    image: "bitcoindevproject/bitcoin:25.0"
    tags:
      - constrained_node
      - resource_limited
      - version_old
    metadata:
      weight: 0.5
      node_type: constrained
    bitcoin_config:
      maxconnections: 8
      maxmempool: 50  # 50MB only
    resources:
      requests:
        cpu: "125m"
        memory: "512Mi"
      limits:
        cpu: "250m"
        memory: "1Gi"
    connections:
      - relay-node-1
      - relay-node-5
  
  - name: constrained-node-2
    image: "bitcoindevproject/bitcoin:24.0"
    tags:
      - constrained_node
      - resource_limited
      - version_very_old
    metadata:
      weight: 0.5
      node_type: constrained
    bitcoin_config:
      maxconnections: 8
      maxmempool: 50
    resources:
      requests:
        cpu: "125m"
        memory: "512Mi"
      limits:
        cpu: "250m"
        memory: "1Gi"
    connections:
      - relay-node-3
      - relay-node-7
  
  - name: constrained-node-3
    image: "bitcoindevproject/bitcoin:25.0"
    tags:
      - constrained_node
      - resource_limited
      - version_old
    metadata:
      weight: 0.5
      node_type: constrained
    bitcoin_config:
      maxconnections: 8
      maxmempool: 50
    resources:
      requests:
        cpu: "125m"
        memory: "512Mi"
      limits:
        cpu: "250m"
        memory: "1Gi"
    connections:
      - relay-node-7
      - relay-node-11
  
  - name: constrained-node-4
    image: "bitcoindevproject/bitcoin:25.0"
    tags:
      - constrained_node
      - resource_limited
      - version_old
    metadata:
      weight: 0.5
      node_type: constrained
    bitcoin_config:
      maxconnections: 8
      maxmempool: 50
    resources:
      requests:
        cpu: "125m"
        memory: "512Mi"
      limits:
        cpu: "250m"
        memory: "1Gi"
    connections:
      - relay-node-14
      - relay-node-18
  
  - name: constrained-node-5
    image: "bitcoindevproject/bitcoin:24.0"
    tags:
      - constrained_node
      - resource_limited
      - version_very_old
    metadata:
      weight: 0.5
      node_type: constrained
    bitcoin_config:
      maxconnections: 8
      maxmempool: 50
    resources:
      requests:
        cpu: "125m"
        memory: "512Mi"
      limits:
        cpu: "250m"
        memory: "1Gi"
    connections:
      - relay-node-18
      - relay-node-20
